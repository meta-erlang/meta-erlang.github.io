<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-guides/guides-development" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">Building SDKs | meta-erlang</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://meta-erlang.github.io/docs/master/guides/guides-development/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="erlang, elixir, yocto"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Building SDKs | meta-erlang"><meta data-rh="true" name="description" content="Building your own SDKs."><meta data-rh="true" property="og:description" content="Building your own SDKs."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://meta-erlang.github.io/docs/master/guides/guides-development/"><link data-rh="true" rel="alternate" href="https://meta-erlang.github.io/docs/master/guides/guides-development/" hreflang="en"><link data-rh="true" rel="alternate" href="https://meta-erlang.github.io/docs/master/guides/guides-development/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="meta-erlang RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="meta-erlang Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2N5Z9W349S"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-2N5Z9W349S",{})</script><link rel="stylesheet" href="/assets/css/styles.9f09e563.css">
<script src="/assets/js/runtime~main.027a576f.js" defer="defer"></script>
<script src="/assets/js/main.c692a59e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">meta-erlang</b></a><a class="navbar__item navbar__link" href="/beamtools/">BEAM Tools</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/master/">Docs</a><a class="navbar__item navbar__link" href="/blog/">Blog</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/master/guides/guides-development/">master</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/master/guides/guides-development/">master</a></li><li><a class="dropdown__link" href="/docs/nanbield/guides/guides-development/">nanbield</a></li><li><a class="dropdown__link" href="/docs/kirkstone0/guides/guides-development/">kirkstone</a></li><li><a class="dropdown__link" href="/docs/scarthgap/guides/guides-development/">scarthgap</a></li></ul></div><a href="https://github.com/meta-erlang/meta-erlang" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item green"><a class="menu__link" href="/docs/master/">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item green"><a class="menu__link" href="/docs/master/guides-quickstart/">Quickstart</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item red"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/master/category/guides/">Guides</a><button aria-label="Collapse sidebar category &#x27;Guides&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/master/guides/guides-a-tiny-recipe/">A tiny recipe</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/master/guides/guides-bitbake-classes/">Bitbake classes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/master/guides/guides-my-application/">My application example</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/master/guides/guides-hello-world/">Hello World examples for meta-erlang</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/master/guides/guides-development/">Building SDKs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/master/guides/guides-beamtools/">BEAM Tools</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item red"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/master/category/applications/">Applications</a><button aria-label="Collapse sidebar category &#x27;Applications&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item green"><a class="menu__link" tabindex="0" href="/docs/master/applications/guides-couchdb/">couchdb</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item green"><a class="menu__link" tabindex="0" href="/docs/master/applications/guides-livebook/">livebook</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item green"><a class="menu__link" tabindex="0" href="/docs/master/applications/guides-rabbitmq/">rabbitmq</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item green"><a class="menu__link" tabindex="0" href="/docs/master/applications/guides-riak/">riak</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item green"><a class="menu__link" tabindex="0" href="/docs/master/applications/guides-vernemq/">vernemq</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item green"><a class="menu__link" tabindex="0" href="/docs/master/applications/guides-tsung/">tsung</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item green"><a class="menu__link" tabindex="0" href="/docs/master/applications/guides-yaws/">yaws</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item green"><a class="menu__link" tabindex="0" href="/docs/master/applications/guides-wings/">wings3d</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item green"><a class="menu__link" tabindex="0" href="/docs/master/applications/guides-epmd/">epmd</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item red"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/master/category/distro/">Distro</a><button aria-label="Collapse sidebar category &#x27;Distro&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item green"><a class="menu__link" tabindex="0" href="/docs/master/distro/guides-axon-layer/">Axon</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item red"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/master/category/contributing/">Contributing</a><button aria-label="Collapse sidebar category &#x27;Contributing&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/master/contributing/contributing-doc-site/">Documentation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/master/contributing/contributing-meta-erlang/">Contributing with meta-erlang</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item green"><a class="menu__link" href="/docs/master/thanks/">Thanks</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for <!-- -->meta-erlang<!-- --> <b>master</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/scarthgap/guides/guides-development/">latest version</a></b> (<!-- -->scarthgap<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/master/category/guides/"><span itemprop="name">Guides</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Building SDKs</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: master</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Building SDKs</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sdk-for-erlang-and-elixir">SDK for Erlang and Elixir<a href="#sdk-for-erlang-and-elixir" class="hash-link" aria-label="Direct link to SDK for Erlang and Elixir" title="Direct link to SDK for Erlang and Elixir">​</a></h2>
<p>The meta-erlang layers includes the possibility to generate development
toolchains enabling better and smooth experience for the developer.</p>
<p>One could easily generates a specific SDK with all tools and libraries needed.
For example: if your project needs Erlang 22.1.8 and Elixir 1.10, you can
generate a SDK having these two dependencies. Then all the developers can share
and use the same SDK during the development phase.</p>
<p>In order to use a specific Erlang and Elixir versions, configure the following
variables in the file
<a href="https://docs.yoctoproject.org/ref-manual/terms.html?highlight=local%20conf#term-Configuration-File" target="_blank" rel="noopener noreferrer">conf/local.conf or in the distro configuration file</a>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PREFERRED_VERSION_erlang = &quot;23.0.4&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PREFERRED_VERSION_erlang-native = &quot;23.0.4&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PREFERRED_VERSION_nativesdk-erlang = &quot;23.0.4&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PREFERRED_VERSION_elixir = &quot;1.11.2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PREFERRED_VERSION_elixir-native = &quot;1.11.2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PREFERRED_VERSION_nativesdk-elixir = &quot;1.11.2&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>The default PACKAGECONFIG for erlang when nativesdk is to enable <em>wx</em> and
<em>observer</em> tools. And if your distribution configuration disables (or removes)
the <em>opengl</em> configuration, you will need to add opengl in
DISTRO_FEATURES_NATIVESDK variable (in or local.conf for instance). Like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">DISTRO_FEATURES_NATIVESDK:append = &quot; opengl&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<p>Maybe your team have special version of Erlang or Elixir with some in-house
patches, using a SDK created by YP is a good approach to follow. You will have
total control from the build until development SDK installation.</p>
<p>Also the SDK have all the dependencies to cross compile applications for target
hardware. So the developer has just one installation to perform in order to
access all the tools.</p>
<p>The recipe
<a href="https://github.com/meta-erlang/meta-erlang/tree/master/recipes-core/meta/meta-erlang-toolchain.bb" target="_blank" rel="noopener noreferrer">meta-erlang-toolchain</a>
is the main entry point when creating a generic toolchain with Erlang and
Elixir. And comes with Erlang, Elixir development modules as well rebar3 build
tool.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The follow two sections are based on
<a href="https://www.yoctoproject.org/docs/3.1.3/sdk-manual/sdk-manual.html" target="_blank" rel="noopener noreferrer">Yocto Project Application Development and the Extensible Software Development Kit (eSDK)</a>
for Yocto Project 3.1.3 LTS &quot;Dunfell&quot;. To get an up-to-date documentation,
please, visit the
<a href="https://docs.yoctoproject.org/index.html" target="_blank" rel="noopener noreferrer">Yocto Project Documentation</a></p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="standard-sdk">Standard SDK<a href="#standard-sdk" class="hash-link" aria-label="Direct link to Standard SDK" title="Direct link to Standard SDK">​</a></h3>
<p>Using the
<a href="https://www.yoctoproject.org/docs/3.1.3/sdk-manual/sdk-manual.html#sdk-using-the-standard-sdk" target="_blank" rel="noopener noreferrer">Standard SDK</a>
is simple as:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bitbake meta-erlang-toolchain</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After finishing the SDK generation command, check the YP
<a href="https://docs.yoctoproject.org/ref-manual/ref-variables.html#term-TMPDIR" target="_blank" rel="noopener noreferrer">TMPDIR</a>.
A new file has been created like this:
<em>poky-glibc-x86_64-meta-erlang-toolchain-armv7vet2hf-neon-qemuarm-toolchain-3.1.3.sh</em>.
The file name depends on many factors like machine configuration and YP version.</p>
<p>The next step is run the toolchain installation script, like this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">~/work/opensource/build/tmp/deploy/sdk/poky-glibc-x86_64-meta-erlang-toolchain-armv7vet2hf-neon-qemuarm-toolchain-3.1.3.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Poky (Yocto Project Reference Distro) SDK installer version 3.1.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter target directory for SDK (default: /opt/poky/3.1.3): /opt/poky/3.1.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">You are about to install the SDK to &quot;/opt/poky/3.1.3&quot;. Proceed [Y/n]?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Extracting SDK.............................................done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Setting it up...done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SDK has been successfully set up and is ready to be used.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Each time you wish to use the SDK in a new shell session, you need to source the environment setup script e.g.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $ . /opt/poky/3.1.3/environment-setup-armv7vet2hf-neon-poky-linux-gnueabi</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As the last sentence says, just source the file
<em>environment-setup-armv7vet2hf-neon-poky-linux-gnueabi</em> and we ready to use
Erlang and Elixir.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>If you need to customize the toolchain, i.e: add or remove tools, YP supports
<a href="https://www.yoctoproject.org/docs/3.1.3/sdk-manual/sdk-manual.html#sdk-appendix-customizing-standard" target="_blank" rel="noopener noreferrer">customize the Standard SDK</a>.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="extensible-sdk">Extensible SDK<a href="#extensible-sdk" class="hash-link" aria-label="Direct link to Extensible SDK" title="Direct link to Extensible SDK">​</a></h3>
<p><a href="https://www.yoctoproject.org/docs/3.1.3/sdk-manual/sdk-manual.html#sdk-extensible" target="_blank" rel="noopener noreferrer">Extensible SDK</a>
is the newly way in order to create SDK with YP. It includes the
<a href="https://www.yoctoproject.org/docs/3.1.3/sdk-manual/sdk-manual.html#using-devtool-in-your-sdk-workflow" target="_blank" rel="noopener noreferrer">devtool</a>
tool to help the development workflow when working with new recipes or testing
with the target hardware.</p>
<p>The instructions for generating an eSDK is as follow:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bitbake core-image-minimal -c populate_sdk_ext</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <em>populate_sdk_ext</em> works only with image recipes. After finishing the
command, it is time to install the SDK like this:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">joaohf@porco:~/tmp/poky$ ~/work/opensource/build/tmp/deploy/sdk/poky-glibc-x86_64-core-image-minimal-armv7vet2hf-neon-qemuarm-toolchain-ext-3.1.3.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Poky (Yocto Project Reference Distro) Extensible SDK installer version 3.1.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter target directory for SDK (default: ~/poky_sdk):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">You are about to install the SDK to &quot;/home/joaohf/poky_sdk&quot;. Proceed [Y/n]?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Extracting SDK..................................................done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Setting it up...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Extracting buildtools...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Preparing build system...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WARNING: /home/joaohf/poky_sdk/layers/poky/meta-axon/recipes-support/glfw/glfw_3.2.1.bb: distro_features_check.bbclass is deprecated, please use features_check.bbclass instead</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Parsing recipes: 100% |#########################################################################################################################################| Time: 0:02:14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Initialising tasks: 100% |######################################################################################################################################| Time: 0:00:01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loading cache: 100% |###########################################################################################################################################| Time: 0:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Initialising tasks: 100% |######################################################################################################################################| Time: 0:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SDK has been successfully set up and is ready to be used.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Each time you wish to use the SDK in a new shell session, you need to source the environment setup script e.g.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $ . /home/joaohf/poky_sdk/environment-setup-armv7vet2hf-neon-poky-linux-gnueabi</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Source the environment setup script for each new shell session that you want to
use the SDK.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Additional tools can also be included if needed, checkout the
<a href="https://www.yoctoproject.org/docs/3.1.3/sdk-manual/sdk-manual.html#sdk-appendix-customizing" target="_blank" rel="noopener noreferrer">Customizing the Extensible SDK</a>
documentation.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="development-session-example">Development session example<a href="#development-session-example" class="hash-link" aria-label="Direct link to Development session example" title="Direct link to Development session example">​</a></h2>
<p>This section shows an example about how to use the SDK during a development
session and exploring how we can use the command
<a href="https://www.yoctoproject.org/docs/3.1.3/sdk-manual/sdk-manual.html#using-devtool-in-your-sdk-workflow" target="_blank" rel="noopener noreferrer">devtool</a>
to help fixing a bug in an Erlang application.</p>
<p>We are going to perform the following steps:</p>
<ul>
<li>created a new bitbake recipe for an Erlang application</li>
<li>build the recipe</li>
<li>create an image and run it using QEMU</li>
<li>execute the Erlang application on QEMU</li>
<li>make a change in the application and use hot code swapping to change the
application, that is, without stop the running application or restart the QEMU
machine</li>
<li>clean up the target QEMU</li>
<li>finish up the recipe</li>
</ul>
<p>One can use the same approach when working with a real hardware.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>This session is far from be generic steps in order to develop, build, test and
deploy Erlang/Elixir projects using Yocto Project. The purpose here is just to
demonstrate one of multiple workflows.</p></div></div>
<p>Let&#x27;s start loading the SDK setup environment:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ cd ~/poky_sdk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ source environment-setup-armv7vet2hf-neon-poky-linux-gnueabi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SDK environment now set up; additionally you may now run devtool to perform development tasks.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Run devtool --help for further details.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For this experience we are going to use a small Erlang application called
<code>elock</code>. Clone it and build using rebar3 build tool.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ git clone https://github.com/joaohf/elock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ cd elock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ rebar3 compile</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Alright, the SDK is working as expected. The rebar3 tool is included into the
SDK as well all the Erlang development requirements. The next step is create an
elock bitbake recipe.</p>
<p>Still in the elock folder, call the <code>devtool add</code> in order to create a standard
bitbake recipe:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ devtool add elock .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Starting bitbake server...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Starting bitbake server...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Reconnecting to bitbake server...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Retrying server connection (#1)...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Reconnecting to bitbake server...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Reconnecting to bitbake server...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Retrying server connection (#1)...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Retrying server connection (#1)...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Starting bitbake server...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO: Using source tree as build directory since that would be the default for this recipe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO: Recipe /home/joaohf/poky_sdk/workspace/recipes/elock/elock_git.bb has been automatically created; further editing may be required to make it fully functional</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>devtool created a new recipe call elock_git.bb. This recipe does not work
because Yocto Project doesn&#x27;t know how to read an Erlang/Elixir project and
generate a proper bitbake recipe. So we need to use a rebar3 plugin called
<a href="https://hex.pm/packages/rebar3_bitbake" target="_blank" rel="noopener noreferrer">rebar3_bitbake</a> which knows how to
create a proper recipe:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ rebar3 bitbake</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ cp elock_0.1.0.bb /home/joaohf/poky_sdk/workspace/recipes/elock/elock_git.bb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now, elock recipe is ready. As the last step before the build, let&#x27;s fix the
recipe version because we want to build and release the version 0.1.0. So, still
using devtool to change the recipe name do:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ devtool rename -V 0.1.0 elock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Starting bitbake server...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Reconnecting to bitbake server...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Retrying server connection (#1)...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loading cache: 100% |##################################################################################################################################################| Time: 0:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loaded 3037 entries from dependency cache.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Parsing recipes: 100% |################################################################################################################################################| Time: 0:00:01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Parsing of 1943 .bb files complete (1937 cached, 6 parsed). 3038 targets, 113 skipped, 0 masked, 0 errors.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO: Renaming /home/joaohf/poky_sdk/workspace/appends/elock_git.bbappend to /home/joaohf/poky_sdk/workspace/appends/elock_0.1.0.bbappend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO: Renaming /home/joaohf/poky_sdk/workspace/recipes/elock/elock_git.bb to /home/joaohf/poky_sdk/workspace/recipes/elock/elock_0.1.0.bb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Finally, call devtool to build the elock recipe like this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ devtool build elock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Starting bitbake server...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Reconnecting to bitbake server...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Retrying server connection (#1)...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loading cache: 100% |##################################################################################################################################################| Time: 0:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loaded 3037 entries from dependency cache.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Parsing recipes: 100% |################################################################################################################################################| Time: 0:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Parsing of 1943 .bb files complete (1942 cached, 1 parsed). 3038 targets, 113 skipped, 0 masked, 0 errors.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loading cache: 100% |##################################################################################################################################################| Time: 0:00:04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loaded 3037 entries from dependency cache.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Parsing recipes: 100% |################################################################################################################################################| Time: 0:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Parsing of 1943 .bb files complete (1942 cached, 1 parsed). 3038 targets, 113 skipped, 0 masked, 0 errors.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Resolving any missing task queue dependencies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Initialising tasks: 100% |#############################################################################################################################################| Time: 0:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sstate summary: Wanted 13 Found 1 Missed 12 Current 137 (7% match, 92% complete)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Executing Tasks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: elock: compiling from external source tree /home/joaohf/work/projetos/elock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Tasks Summary: Attempted 613 tasks of which 608 didn&#x27;t need to be rerun and all succeeded.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Awesome, everything works. Now we need to build an image which has a working
Linux distro made with Yocto Project:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ devtool build-image core-image-minimal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Starting bitbake server...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Reconnecting to bitbake server...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Retrying server connection (#1)...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loading cache: 100% |##################################################################################################################################################| Time: 0:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loaded 3037 entries from dependency cache.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Parsing recipes: 100% |################################################################################################################################################| Time: 0:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Parsing of 1943 .bb files complete (1942 cached, 1 parsed). 3038 targets, 113 skipped, 0 masked, 0 errors.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO: Building image core-image-minimal with the following additional packages: elock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loading cache: 100% |##################################################################################################################################################| Time: 0:00:04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loaded 3037 entries from dependency cache.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Parsing recipes: 100% |################################################################################################################################################| Time: 0:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Parsing of 1943 .bb files complete (1941 cached, 2 parsed). 3038 targets, 113 skipped, 0 masked, 0 errors.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Resolving any missing task queue dependencies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Initialising tasks: 100% |#############################################################################################################################################| Time: 0:00:05</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sstate summary: Wanted 98 Found 1 Missed 97 Current 877 (1% match, 90% complete)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Executing Tasks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Tasks Summary: Attempted 2649 tasks of which 2423 didn&#x27;t need to be rerun and all succeeded.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO: Successfully built core-image-minimal. You can find output files in /home/joaohf/poky_sdk/tmp/deploy/images/qemuarm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>So far we build elock application as well the core-image-minimal. Now, it is
time to running the image using qemu.</p>
<p>Open a new shell session and source again the SDK environment variables. This is
necessary because QEMU will block the terminal.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ cd ~/poky_sdk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ source environment-setup-armv7vet2hf-neon-poky-linux-gnueabi</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And then, start the QEMU:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ devtool runqemu core-image-minimal</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>QEMU will start its booting process and we can connect over ssh to the IP
address 192.168.7.2 using <em>root</em> as ssh user.</p>
<p>But our main aim now is to install the elock application into the QEMU instance.
The core-image-minimal does not have the elock installed. So, let&#x27;s install it
right now calling devtool and the deploy-target subcommand, like this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ devtool deploy-target elock root@192.168.7.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Starting bitbake server...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Reconnecting to bitbake server...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Retrying server connection (#1)...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loading cache: 100% |##################################################################################################################################################| Time: 0:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loaded 3037 entries from dependency cache.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Parsing recipes: 100% |################################################################################################################################################| Time: 0:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Parsing of 1943 .bb files complete (1942 cached, 1 parsed). 3038 targets, 113 skipped, 0 masked, 0 errors.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO: Successfully deployed /home/joaohf/poky_sdk/tmp/work/armv7vet2hf-neon-poky-linux-gnueabi/elock/0.1.0-r0/image</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>elock has been installed, however it is not started yet. In order to start it
for the first time, open a new terminal, connect over ssh and start elock
application:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh root@192.168.7.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@qemuarm:~# cd /usr/lib/elock/bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@qemuarm:/usr/lib/elock/bin# ./elock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Erlang/OTP 23 [erts-11.1.3] [source] [smp:1:1] [ds:1:1:10] [async-threads:1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=WARNING REPORT==== 20-Nov-2020::20:14:43.909058 ===</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Setting Ranch options together with socket options is deprecated. Please use the new map syntax that allows specifying socket options separately from other options.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Eshell V11.1.3  (abort with ^G)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Ok, elock is up and running. Back to the development terminal and let&#x27;s test if
elock is working:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ssh -p 4050 admin@192.168.7.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The authenticity of host &#x27;[192.168.7.2]:4050 ([192.168.7.2]:4050)&#x27; can&#x27;t be established.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RSA key fingerprint is SHA256:VXMXRo0wQnsCC5rFxuOy4rT3NSc5NLjoxvtcLpa0OFI.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Warning: Permanently added &#x27;[192.168.7.2]:4050&#x27; (RSA) to the list of known hosts.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SSH server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter password for &quot;admin&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter command or `help`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">elock&gt; get_code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---&gt; {ok,&lt;&lt;&quot;12345&quot;&gt;&gt;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">elock&gt; exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Nice, it works! But, we want to change the default code from <em>12345</em> to <em>7777</em>.
What we are going to do is fix the default code, redeploy and verify if the hot
swap code worked as expected:</p>
<p>Change the elock application like this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">diff --git a/src/elock_statem.erl b/src/elock_statem.erl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">index fc0b10e..3f88dd4 100644</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--- a/src/elock_statem.erl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+++ b/src/elock_statem.erl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@@ -24,7 +24,7 @@ get_timeout() -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> set_timeout(Tmo) -&gt; ok.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> get_code() -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-    {ok, &lt;&lt;&quot;12345&quot;&gt;&gt;}.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+    {ok, &lt;&lt;&quot;77777&quot;&gt;&gt;}.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Build the recipe with the changes made.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ devtool build elock</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And deploy elock. The deploy-target subcommand will take care about copying the
files to the target directory.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ devtool deploy-target elock root@192.168.7.2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Switch to the ssh session and load the elock_statem code using
<code>code:load_file/1</code>. This is the most basic way to perform hot code swapping.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">code:load_file(elock_statem).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{module,elock_statem}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now, it is time to connect again over ssh 4050 port and check if the new pass
code takes effect:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ssh -p 4050 admin@192.168.7.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The authenticity of host &#x27;[192.168.7.2]:4050 ([192.168.7.2]:4050)&#x27; can&#x27;t be established.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RSA key fingerprint is SHA256:VXMXRo0wQnsCC5rFxuOy4rT3NSc5NLjoxvtcLpa0OFI.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Warning: Permanently added &#x27;[192.168.7.2]:4050&#x27; (RSA) to the list of known hosts.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SSH server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter password for &quot;admin&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter command or `help`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">elock&gt; get_code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---&gt; {ok,&lt;&lt;&quot;77777&quot;&gt;&gt;}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>It works! We are very very happy with all these changes. Time to clean up the
target hardware, that is, remove the elock files (this is not strict necessary,
but just to show that it is possible):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ devtool undeploy-target elock root@192.168.7.2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now, the last step is to finish up all the recipe changes. The subcommand
<em>finish</em> creates any patches corresponding to commits in the local repository,
moves the new recipe to a specific layer and resets the recipe moving it from
the workspace to the layer.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ devtool finish -f elock meta-axon</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Finally, just check the final recipe results:
<em>~/poky_sdk/layers/poky/meta-axon/recipes-elock/elock/elock_0.1.0.bb</em></p>
<p>All done. We&#x27;ve created a recipe, change the Erlang application, deployed it on
the target hardware, applied a fix using hot code swapping without stopping the
application, checked the fix and finished up the recipe changes.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/meta-erlang/meta-erlang.github.io/tree/master/docs/guides/guides-development.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/master/guides/guides-hello-world/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Hello World examples for meta-erlang</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/master/guides/guides-beamtools/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">BEAM Tools</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#sdk-for-erlang-and-elixir" class="table-of-contents__link toc-highlight">SDK for Erlang and Elixir</a><ul><li><a href="#standard-sdk" class="table-of-contents__link toc-highlight">Standard SDK</a></li><li><a href="#extensible-sdk" class="table-of-contents__link toc-highlight">Extensible SDK</a></li></ul></li><li><a href="#development-session-example" class="table-of-contents__link toc-highlight">Development session example</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://erlangforums.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Erlang Forums<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://elixirforum.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Elixir Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://erlef.org/wg/embedded" target="_blank" rel="noopener noreferrer" class="footer__link-item">EEF Embedded Working Group<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog/">Blog</a></li><li class="footer__item"><a href="https://github.com/meta-erlang/meta-erlang" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 meta-erlang</div></div></div></footer></div>
</body>
</html>