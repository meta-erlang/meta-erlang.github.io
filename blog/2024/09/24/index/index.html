<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">fwup for A/B image upgrades | meta-erlang</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://meta-erlang.github.io/blog/2024/09/24/index/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="keywords" content="erlang, elixir, yocto"><meta data-rh="true" property="og:title" content="fwup for A/B image upgrades | meta-erlang"><meta data-rh="true" name="description" content="This blog post is a tutorial about how to make A/B software updates with fwup"><meta data-rh="true" property="og:description" content="This blog post is a tutorial about how to make A/B software updates with fwup"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-09-24T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/joaohf"><meta data-rh="true" property="article:tag" content="meta-erlang,fwup"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://meta-erlang.github.io/blog/2024/09/24/index/"><link data-rh="true" rel="alternate" href="https://meta-erlang.github.io/blog/2024/09/24/index/" hreflang="en"><link data-rh="true" rel="alternate" href="https://meta-erlang.github.io/blog/2024/09/24/index/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://meta-erlang.github.io/blog/2024/09/24/index","mainEntityOfPage":"https://meta-erlang.github.io/blog/2024/09/24/index","url":"https://meta-erlang.github.io/blog/2024/09/24/index","headline":"fwup for A/B image upgrades","name":"fwup for A/B image upgrades","description":"This blog post is a tutorial about how to make A/B software updates with fwup","datePublished":"2024-09-24T00:00:00.000Z","author":{"@type":"Person","name":"João Henrique Ferreira de Freitas","description":"Maintainer of meta-erlang","url":"https://github.com/joaohf","image":"https://github.com/joaohf.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://meta-erlang.github.io/blog","name":"meta-erlang news"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="meta-erlang RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="meta-erlang Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2N5Z9W349S"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-2N5Z9W349S",{})</script><link rel="stylesheet" href="/assets/css/styles.48fe61b0.css">
<script src="/assets/js/runtime~main.00675dd2.js" defer="defer"></script>
<script src="/assets/js/main.c4881ff8.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">meta-erlang</b></a><a class="navbar__item navbar__link" href="/beamtools/">BEAM Tools</a><a class="navbar__item navbar__link" href="/docs/scarthgap/">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/">Blog</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/scarthgap/">scarthgap</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/master/">master</a></li><li><a class="dropdown__link" href="/docs/nanbield/">nanbield</a></li><li><a class="dropdown__link" href="/docs/kirkstone0/">kirkstone</a></li><li><a class="dropdown__link" href="/docs/scarthgap/">scarthgap</a></li></ul></div><a href="https://github.com/meta-erlang/meta-erlang" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/10/12/index/">Running Erlang/OTP test suite on target with ptest</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/10/06/index/">Anatomy of erlang and elixir packages for YP/OE</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/2024/09/24/index/">fwup for A/B image upgrades</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/05/31/index/">New Erlang releases 27.0</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/04/28/index/">livebook server</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/04/21/index/">New Erlang releases 24.3.4.17, 25.3.2.12, 26.2.5, 27.0-rc3</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/03/17/index/">New Erlang releases 24.3.4.16, 25.3.2.10, 26.2.3</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/12/25/index/">New Erlang releases 24.3.4.15, 25.3.2.8, 26.2.1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/11/02/index/">meta-erlang meets atomvm</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/09/02/index/">Exploring x32 psABI for Erlang/OTP</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/07/01/index/">New Erlang releases 24.3.4.13, 25.3.2.3, 26.0.2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/06/09/index/">New meta-erlang branch mickledore</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/05/07/index/">New Erlang releases 24.3.4.11, 25.3.2 and recipe updates</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/02/04/index/">meta-erlang on cloud II: building your own application</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/01/29/index/">meta-erlang on cloud I: EWAOL based</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/01/22/index/">New Erlang releases 24.3.4.8, 25.1.2.1, 25.2.1</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2022</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/welcome/">Welcome</a></li></ul></div></nav></aside><main class="col col--7"><article><header><h1 class="title_f1Hy">fwup for A/B image upgrades</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-09-24T00:00:00.000Z">September 24, 2024</time> · <!-- -->9 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/joaohf" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/joaohf.png" alt="João Henrique Ferreira de Freitas"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/joaohf" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">João Henrique Ferreira de Freitas</span></a></div><small class="authorTitle_nd0D" title="Maintainer of meta-erlang">Maintainer of meta-erlang</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>This blog post is a tutorial about how to make A/B software updates with fwup
tool and Yocto Project.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="objectives-and-tools">Objectives and Tools<a href="#objectives-and-tools" class="hash-link" aria-label="Direct link to Objectives and Tools" title="Direct link to Objectives and Tools">​</a></h2>
<p>A short sentence as requirement for this tutorial is:</p>
<blockquote>
<p>I wish to make an image using Yocto Project and be able to run software
updates using A/B approach.</p>
</blockquote>
<p>There are many references on the Internet for A/B software updates. It&#x27;s a
well-known approach with many different implementations. In short it&#x27;s strategy
to minimize downtime when changing the firmware of embedded devices. While the
new software gets written to the unused slot and the current slot is still
running. When everything are ready to swap, the system gets restarted. Booting
using the unused slot (now it becomes the current slot).</p>
<p>So, in this blog post we are going to play with A/B software updates using fwup
tool.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-fwup-">What is fwup ?<a href="#what-is-fwup-" class="hash-link" aria-label="Direct link to What is fwup ?" title="Direct link to What is fwup ?">​</a></h2>
<p>The best <a href="https://github.com/fwup-home/fwup" target="_blank" rel="noopener noreferrer">fwup</a> definition is from its
official project home:</p>
<blockquote>
<p>fwup is a configurable image-based software update utility for embedded
Linux-based systems. It primarily supports software upgrade strategies that
update entire root filesystem images at once. This includes strategies like
swapping back and forth between A and B partitions, recovery partitions, and
various trial update/failback scenarios. All software update information is
combined into a ZIP archive that may optionally be cryptographically signed.
fwup has minimal dependencies and runtime requirements. Scripts are
intentionally limited to make failure scenarios easier to reason about.
Distribution of software update archives is not a feature. Users can call out
to fwup to run upgrades from external media, stream them from the network, or
script them using a tool like Ansible if so desired.</p>
</blockquote>
<p>In practice, fwup is simple and easy to use.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ypoe-setup">YP/OE setup<a href="#ypoe-setup" class="hash-link" aria-label="Direct link to YP/OE setup" title="Direct link to YP/OE setup">​</a></h2>
<p>I&#x27;ll try to simplify the YP/OE setup to just tree small steps:</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The YP documentation is very good. I strong recommend its reading. For this
section the release version used is
<a href="https://docs.yoctoproject.org/brief-yoctoprojectqs/index.html" target="_blank" rel="noopener noreferrer">scarthgap</a>.</p><p>One important point is to double check the
<a href="https://docs.yoctoproject.org/ref-manual/system-requirements.html#required-packages-for-the-build-host." target="_blank" rel="noopener noreferrer">Required Packages for the Build Host</a></p></div></div>
<ol>
<li>
<p>Cloning all repositories for scarthgap release:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git clone --branch scarthgap git://git.yoctoproject.org/poky</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone --branch scarthgap https://github.com/openembedded/meta-openembedded.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone --branch scarthgap https://github.com/fwup-home/meta-fwup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone --branch scarthgap https://github.com/meta-erlang/meta-erlang</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone --branch scarthgap https://github.com/meta-erlang/meta-axon</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Source the init build environment script:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd poky</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source oe-init-build-env ../build</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Add the needed layers:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bitbake-layers add-layer ../meta-openembedded/meta-oe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bitbake-layers add-layer ../meta-erlang</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bitbake-layers add-layer ../meta-axon</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bitbake-layers add-layer ../meta-fwup</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>Why four layers are needed ? Because the YP/OE approach is to isolate components
into layer in order to maximize the software reusability.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-the-build-environment">Configuring the build environment<a href="#configuring-the-build-environment" class="hash-link" aria-label="Direct link to Configuring the build environment" title="Direct link to Configuring the build environment">​</a></h2>
<p>For this tutorial, the quickest way is edit and add the <em>conf/local.conf</em>
configuration file.</p>
<p>We start defining the MACHINE and DISTRO:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MACHINE = &quot;raspberrypi0-wifi&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DISTRO = &quot;poky&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The layer
<a href="https://meta-raspberrypi.readthedocs.io/en/latest/readme.html" target="_blank" rel="noopener noreferrer">meta-raspberry</a>
provides the machine <em>raspberrypi0-wifi</em> which is what I&#x27;m using for this
demonstration as my current development board is a raspberry pi 0.</p>
<p>Next, we need to enable some raspberry features like UART and USB host support
(it&#x27;s important to get some network connectivity):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tee -a &lt;&lt;EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># https://meta-raspberrypi.readthedocs.io/en/latest/extra-build-config.html#enable-uart</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENABLE_UART = &quot;1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># https://meta-raspberrypi.readthedocs.io/en/latest/extra-build-config.html#enable-usb-host-support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENABLE_DWC2_PERIPHERAL = &quot;1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># add some package to allow networking</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IMAGE_INSTALL:append = &quot; raspi2go kernel-module-libcomposite kernel-module-g-ether kernel-module-dwc2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As YP/OE supports many types of image outputs, we want to be specific here and
pick only the <em>fwup</em> type.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tee -a &lt;&lt;EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># enable support for making fwup images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IMAGE_CLASSES += &quot;image_types_fwup&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IMAGE_FSTYPES = &quot;fwup&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The fwup type is provided by the bbclass
<a href="https://github.com/fwup-home/meta-fwup/blob/master/classes/image_types_fwup.bbclass" target="_blank" rel="noopener noreferrer">image_types_fwup.bbclass</a>.
It relies on wic image generator and uses their build artifacts for bootloader
and rootfs.</p>
<p>Ok, now we also want to include Erlang/OTP and Elixir. As meta-erlang provides
many versions, I recommend to stick with a specific one. In our case the latest
1.17.x and 27.0.x are good:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tee -a &lt;&lt;EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># select specific elixir and erlang versions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PREFERRED_VERSION_elixir = &quot;1.17%&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PREFERRED_VERSION_elixir-native = &quot;1.17%&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PREFERRED_VERSION_nativesdk-elixir = &quot;1.17%&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PREFERRED_VERSION_erlang = &quot;27.0%&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PREFERRED_VERSION_erlang-native = &quot;27.0%&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PREFERRED_VERSION_nativesdk-erlang = &quot;27.0%&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Finally, add erlang and elixir to the image:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tee -a &lt;&lt;EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># add erlang and elixir into image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IMAGE_INSTALL:append = &quot; erlang elixir&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now that the configuration is over. Let&#x27;s start a build:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bitbake core-image-full-cmdline</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>It might take some time for the first build. As YP/OE will build everything from
scratch. The next builds should be faster.</p></div></div>
<p>Once the build has finished, let&#x27;s inspect the build outputs:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd tmp/deploy/images/raspberrypi0-wifi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ls -l core-image-full-cmdline*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 2 builder builder 68465478 Sep 24 21:19 core-image-full-cmdline-raspberrypi0-wifi.rootfs-20240924200317.fw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx 2 builder builder       66 Sep 24 21:19 core-image-full-cmdline-raspberrypi0-wifi.rootfs.fw -&gt; core-image-full-cmdline-raspberrypi0-wifi.rootfs-20240924200317.fw</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The folder <em>tmp/deploy/images/raspberrypi0-wifi</em> has many files generated from
the build tasks. We are interested only the final .fw file. In this case we the
file <em>core-image-full-cmdline-raspberrypi0-wifi.rootfs-20240924200317.fw</em> is
what we need.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploying-fw-images">Deploying .fw images<a href="#deploying-fw-images" class="hash-link" aria-label="Direct link to Deploying .fw images" title="Direct link to Deploying .fw images">​</a></h2>
<p>Before deploying, let&#x27;s understand a bit the image partition layout created by
YP/OE and fwup tool:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># +----------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># | MBR                        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># +----------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># | Firmware configuration data|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># | (formatted as uboot env)   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># +----------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># | p0*: Boot A (FAT32)        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># | zImage, bootcode.bin,      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># | config.txt, etc.           |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># +----------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># | p0*: Boot B (FAT32)        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># +----------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># | p1*: Rootfs A (ext4)       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># +----------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># | p1*: Rootfs B (ext4)       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># +----------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># | p2: Application (ext4)     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># +----------------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>There is a total of three partitions. Where partition p0 and p1 have been
divided by half each one. It&#x27;s not clear to get this idea. So, I recommend you
to take a look into fwup configuration file used by this tutorial,
<a href="https://github.com/meta-erlang/meta-axon/blob/master/fwup/core-image-full-cmdline.raspberrypi0-wifi.fwup" target="_blank" rel="noopener noreferrer">core-image-full-cmdline.raspberrypi0-wifi.fwup</a>.
That file has been adapted from the original
<a href="https://github.com/nerves-project/nerves_system_rpi0/blob/main/fwup.conf" target="_blank" rel="noopener noreferrer">nerves_system_rpi0 fwup configuration</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="burn-a-complete-image">burn a complete image<a href="#burn-a-complete-image" class="hash-link" aria-label="Direct link to burn a complete image" title="Direct link to burn a complete image">​</a></h3>
<p>My target sdcard has 16GB there is enough space for the core-image-full-cmdline
image. To start using it we need write a <em>complete</em> image to the sdcard. By
complete image also means the the partition A will be used when the board gets
booted.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo fwup -a -d /dev/sda -t complete -i core-image-full-cmdline-raspberrypi0-wifi.rootfs-20240924200317.fw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">100% [====================================] 68.46 MB in / 382.20 MB out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Success!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Elapsed time: 55.932 s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When I inserted the sdcard into my workstation, my host Linux recognized it as
<em>/dev/sda</em> device, using sudo when calling fwup took almost 56 seconds to write
382 MB to the sdcard.</p>
<p>That is all we need to get the sdcard and boot it into raspberry board.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The next output is just the partition layout for a real board booted from the
sdcard.</p></div></div>
<p>And in fact, it works as expected:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@raspberrypi0-wifi:~# sfdisk -l /dev/mmcblk0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Disk /dev/mmcblk0: 14.84 GiB, 15931539456 bytes, 31116288 sectors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Units: sectors of 1 * 512 = 512 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sector size (logical/physical): 512 bytes / 512 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Disklabel type: dos</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Disk identifier: 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Device         Boot   Start      End  Sectors  Size Id Type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/dev/mmcblk0p1 *         63   266302   266240  130M  c W95 FAT32 (LBA)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/dev/mmcblk0p2       532543  1011774   479232  234M 83 Linux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/dev/mmcblk0p3      1491007 31116287 29625281 14.1G 83 Linux</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Checking erl and iex versions:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@raspberrypi0-wifi:~# erl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Erlang/OTP 27 [erts-15.0.1] [source] [32-bit] [smp:1:1] [ds:1:1:10] [async-threads:1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Eshell V15.0.1 (press Ctrl+G to abort, type help(). for help)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">User switch command (type h for help)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --&gt; q</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@raspberrypi0-wifi:~# iex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Erlang/OTP 27 [erts-15.0.1] [source] [32-bit] [smp:1:1] [ds:1:1:10] [async-threads:1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">warning: the VM is running with native name encoding of latin1 which may cause Elixir to malfunction as it expects utf8. Please ensure your locale is set to UTF-8 (whiche</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Interactive Elixir (1.17.1) - press Ctrl+C to exit (type h() ENTER for help)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">iex(1)&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="move-to-b-partition">move to B partition<a href="#move-to-b-partition" class="hash-link" aria-label="Direct link to move to B partition" title="Direct link to move to B partition">​</a></h3>
<p>Still using the image
core-image-full-cmdline-raspberrypi0-wifi.rootfs-20240924200317.fw, I want to
test the B upgrade path. For that, the easiest way is to call fwup (which has
been installed into the image) passing some usual flags for this
<a href="https://github.com/fwup-home/fwup?tab=readme-ov-file#whats-something-cool-that-you-can-do-with-fwup" target="_blank" rel="noopener noreferrer">kind of operation</a>:</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The instructions for setting board&#x27;s network stack using USB is not part of the
scope of this tutorial.</p></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ cat core-image-full-cmdline-raspberrypi0-wifi.rootfs-20240924200317.fw | ssh root@192.168.7.7 &#x27;fwup -v -a -U -d /dev/mmcblk0 -t upgrade.b&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fwup: require-partition-offset(1, 532543) -&gt; met</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fwup: require-uboot-variable(uboot-env, a.nerves_fw_platform) -&gt; met</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fwup: require-uboot-variable(uboot-env, a.nerves_fw_architecture) -&gt; met</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fwup: Upgrading partition B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">100% [====================================] 68.46 MB in / 381.82 MB out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Success!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Elapsed time: 1 min 30 s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The important argument is the <code>-t upgrade.b</code> telling to fwup which partition
will be upgraded.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>In my setup I called <code>reboot</code> to get raspberry rebooted.</p></div></div>
<p>Checking erl and iex versions:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@raspberrypi0-wifi:~# erl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Erlang/OTP 27 [erts-15.0.1] [source] [32-bit] [smp:1:1] [ds:1:1:10] [async-threads:1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Eshell V15.0.1 (press Ctrl+G to abort, type help(). for help)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">User switch command (type h for help)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --&gt; q</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@raspberrypi0-wifi:~# iex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Erlang/OTP 27 [erts-15.0.1] [source] [32-bit] [smp:1:1] [ds:1:1:10] [async-threads:1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">warning: the VM is running with native name encoding of latin1 which may cause Elixir to malfunction as it expects utf8. Please ensure your locale is set to UTF-8 (whiche</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Interactive Elixir (1.17.1) - press Ctrl+C to exit (type h() ENTER for help)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">iex(1)&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The versions are still 1.17.x and 27.0.x, as expected.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="move-from-b-to-a-partition">move from B to A partition<a href="#move-from-b-to-a-partition" class="hash-link" aria-label="Direct link to move from B to A partition" title="Direct link to move from B to A partition">​</a></h3>
<p>For testing purposes, let&#x27;s change the Elixir preferred version from 1.17.x to
1.16.x. For that, edit the local.conf file and change the
<code>PREFERRED_VERSION_elixir*</code> variables:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tee -a &lt;&lt;EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># select specific elixir and erlang versions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PREFERRED_VERSION_elixir = &quot;1.16%&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PREFERRED_VERSION_elixir-native = &quot;1.16%&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PREFERRED_VERSION_nativesdk-elixir = &quot;1.16%&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Running the build again:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bitbake core-image-full-cmdline</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The result will be a new core-image-full-cmdline-raspberrypi0-wifi.rootfs-*.fw
filename which is ready to be used:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ cat core-image-full-cmdline-raspberrypi0-wifi.rootfs-20240920190231.fw | ssh root@192.168.7.7 &#x27;fwup -v -a -U -d /dev/mmcblk0 -t upgrade.a&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fwup: require-partition-offset(1, 1011775) -&gt; met</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fwup: require-uboot-variable(uboot-env, b.nerves_fw_platform) -&gt; met</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fwup: require-uboot-variable(uboot-env, b.nerves_fw_architecture) -&gt; met</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fwup: Upgrading partition A</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">100% [====================================] 68.46 MB in / 381.82 MB out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Success!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Elapsed time: 1 min 30 s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Rebooting the board and checking the iex version, we get:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@raspberrypi0-wifi:~# erl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Erlang/OTP 27 [erts-15.0.1] [source] [32-bit] [smp:1:1] [ds:1:1:10] [async-threads:1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Eshell V15.0.1 (press Ctrl+G to abort, type help(). for help)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">User switch command (type h for help)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --&gt; q</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@raspberrypi0-wifi:~# iex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">warning: the VM is running with native name encoding of latin1 which may cause Elixir to malfunction as it expects utf8. Please ensure your locale is set to UTF-8 (whiche</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Erlang/OTP 27 [erts-15.0.1] [source] [32-bit] [smp:1:1] [ds:1:1:10] [async-threads:1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Interactive Elixir (1.16.3) - press Ctrl+C to exit (type h() ENTER for help)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>That works! Erlang/OTP 27 and Elixir 1.16.3.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusions">Conclusions<a href="#conclusions" class="hash-link" aria-label="Direct link to Conclusions" title="Direct link to Conclusions">​</a></h2>
<p>The <a href="https://github.com/fwup-home/fwup" target="_blank" rel="noopener noreferrer">fwup</a> tool has shown as a feasibly
approach for image A/B software upgrades. It is integrated into YP/OE ecosystem
through <a href="https://github.com/fwup-home/meta-fwup" target="_blank" rel="noopener noreferrer">meta-fwup</a> layer and ready to
try.</p>
<p>fwup is also used by Nerves Project together with others Elixir components in
order to provide a full
<a href="https://en.wikipedia.org/wiki/Over-the-air_update" target="_blank" rel="noopener noreferrer">OTA updates</a>.</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/meta-erlang/">meta-erlang</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/fwup/">fwup</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/meta-erlang/meta-erlang.github.io/tree/master/blog/2024-09-24/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2024/10/06/index/"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Anatomy of erlang and elixir packages for YP/OE</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2024/05/31/index/"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">New Erlang releases 27.0</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#objectives-and-tools" class="table-of-contents__link toc-highlight">Objectives and Tools</a></li><li><a href="#what-is-fwup-" class="table-of-contents__link toc-highlight">What is fwup ?</a></li><li><a href="#ypoe-setup" class="table-of-contents__link toc-highlight">YP/OE setup</a></li><li><a href="#configuring-the-build-environment" class="table-of-contents__link toc-highlight">Configuring the build environment</a></li><li><a href="#deploying-fw-images" class="table-of-contents__link toc-highlight">Deploying .fw images</a><ul><li><a href="#burn-a-complete-image" class="table-of-contents__link toc-highlight">burn a complete image</a></li><li><a href="#move-to-b-partition" class="table-of-contents__link toc-highlight">move to B partition</a></li><li><a href="#move-from-b-to-a-partition" class="table-of-contents__link toc-highlight">move from B to A partition</a></li></ul></li><li><a href="#conclusions" class="table-of-contents__link toc-highlight">Conclusions</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://erlangforums.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Erlang Forums<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://elixirforum.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Elixir Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://erlef.org/wg/embedded" target="_blank" rel="noopener noreferrer" class="footer__link-item">EEF Embedded Working Group<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog/">Blog</a></li><li class="footer__item"><a href="https://github.com/meta-erlang/meta-erlang" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 meta-erlang</div></div></div></footer></div>
</body>
</html>