<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Anatomy of erlang and elixir packages for YP/OE | meta-erlang</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://meta-erlang.github.io/blog/2024/10/06/index/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="keywords" content="erlang, elixir, yocto"><meta data-rh="true" property="og:title" content="Anatomy of erlang and elixir packages for YP/OE | meta-erlang"><meta data-rh="true" name="description" content="Usually, when designing a linux distribution using YP/OE we want a slim image"><meta data-rh="true" property="og:description" content="Usually, when designing a linux distribution using YP/OE we want a slim image"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-10-06T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/joaohf"><meta data-rh="true" property="article:tag" content="meta-erlang,x32"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://meta-erlang.github.io/blog/2024/10/06/index/"><link data-rh="true" rel="alternate" href="https://meta-erlang.github.io/blog/2024/10/06/index/" hreflang="en"><link data-rh="true" rel="alternate" href="https://meta-erlang.github.io/blog/2024/10/06/index/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://meta-erlang.github.io/blog/2024/10/06/index","mainEntityOfPage":"https://meta-erlang.github.io/blog/2024/10/06/index","url":"https://meta-erlang.github.io/blog/2024/10/06/index","headline":"Anatomy of erlang and elixir packages for YP/OE","name":"Anatomy of erlang and elixir packages for YP/OE","description":"Usually, when designing a linux distribution using YP/OE we want a slim image","datePublished":"2024-10-06T00:00:00.000Z","author":{"@type":"Person","name":"João Henrique Ferreira de Freitas","description":"Maintainer of meta-erlang","url":"https://github.com/joaohf","image":"https://github.com/joaohf.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://meta-erlang.github.io/blog","name":"meta-erlang news"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="meta-erlang RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="meta-erlang Atom Feed"><link rel="stylesheet" href="/assets/css/styles.5fa5e897.css">
<script src="/assets/js/runtime~main.ef62c1da.js" defer="defer"></script>
<script src="/assets/js/main.1ab31bf7.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">meta-erlang</b></a><a class="navbar__item navbar__link" href="/beamtools/intro/">BEAM Tools</a><a class="navbar__item navbar__link" href="/docs/scarthgap/">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/community/support/">Community</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/scarthgap/">scarthgap</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/master/">master</a></li><li><a class="dropdown__link" href="/docs/nanbield/">nanbield</a></li><li><a class="dropdown__link" href="/docs/kirkstone0/">kirkstone</a></li><li><a class="dropdown__link" href="/docs/scarthgap/">scarthgap</a></li></ul></div><a href="https://github.com/meta-erlang/meta-erlang" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/09/26/index/">Testing meta-erlang with LuX</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/09/25/index/">beamruntime</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/07/27/index/">Erlang-Red, recipe introduction</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/05/11/index/">autotools as build tool for Erlang/OTP projects</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/04/19/index/">New Erlang releases 25.3.2.20, 26.2.5.11, 27.3.3</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/03/21/index/">fwup for A/B image upgrades on raspberrypi machines with NervesCloud, part I</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/01/26/index/">fwup for A/B image upgrades on QEMU machines with NervesCloud, part III</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/12/20/index/">fwup for A/B image upgrades on QEMU machines with fwup, part II</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/11/03/index/">Introducing Gleam to meta-erlang layer</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/10/12/index/">Running Erlang/OTP test suite on target with ptest</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/2024/10/06/index/">Anatomy of erlang and elixir packages for YP/OE</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/09/24/index/">fwup for A/B image upgrades, part I</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/05/31/index/">New Erlang releases 27.0</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/04/28/index/">livebook server</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/04/21/index/">New Erlang releases 24.3.4.17, 25.3.2.12, 26.2.5, 27.0-rc3</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/03/17/index/">New Erlang releases 24.3.4.16, 25.3.2.10, 26.2.3</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/12/25/index/">New Erlang releases 24.3.4.15, 25.3.2.8, 26.2.1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/11/02/index/">meta-erlang meets atomvm</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/09/02/index/">Exploring x32 psABI for Erlang/OTP</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/07/01/index/">New Erlang releases 24.3.4.13, 25.3.2.3, 26.0.2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/06/09/index/">New meta-erlang branch mickledore</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/05/07/index/">New Erlang releases 24.3.4.11, 25.3.2 and recipe updates</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/02/04/index/">meta-erlang on cloud II: building your own application</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/01/29/index/">meta-erlang on cloud I: EWAOL based</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/01/22/index/">New Erlang releases 24.3.4.8, 25.1.2.1, 25.2.1</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2022</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/welcome/">Welcome</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">Anatomy of erlang and elixir packages for YP/OE</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-10-06T00:00:00.000Z">October 6, 2024</time> · <!-- -->8 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/joaohf" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/joaohf.png" alt="João Henrique Ferreira de Freitas"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/joaohf" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">João Henrique Ferreira de Freitas</span></a></div><small class="authorTitle_nd0D" title="Maintainer of meta-erlang">Maintainer of meta-erlang</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>Usually, when designing a linux distribution using YP/OE we want a slim image
with only what we need to run a specific application (or applications). In this
post we&#x27;ll discuss a bit about erlang and elixir packages that meta-erlang layer
provides.</p>
<p>It&#x27;s important to know how the packages are divided into smaller ones in order
to offer a better composition when creating linux distributions with YP/OE.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="environment-setup">Environment setup<a href="#environment-setup" class="hash-link" aria-label="Direct link to Environment setup" title="Direct link to Environment setup">​</a></h2>
<ol>
<li>
<p>Cloning all repositories for master branch:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git clone --branch master git://git.yoctoproject.org/poky</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone --branch master https://github.com/openembedded/meta-openembedded.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone --branch master https://github.com/meta-erlang/meta-erlang</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone --branch master https://github.com/meta-erlang/meta-axon</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Source the init build environment script:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd poky</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source oe-init-build-env ../build</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Add the needed layers:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bitbake-layers add-layer ../meta-openembedded/meta-oe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bitbake-layers add-layer ../meta-erlang</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bitbake-layers add-layer ../meta-axon</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Configure the <code>conf/local.conf</code> and enable multiconfig builds:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tee -a &lt;&lt;EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># debug-tweaks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXTRA_IMAGE_FEATURES ?= &quot;debug-tweaks&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">USER_CLASSES ?= &quot;buildhistory buildstats&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BUILDHISTORY_COMMIT = &quot;1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PACKAGE_CLASSES = &quot;package_ipk&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PATCHRESOLVE = &quot;noop&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INHERIT += &quot;rm_work&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RM_WORK_EXCLUDE = &quot;erlang erlang-native nativesdk-erlang&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># diskmon</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BB_DISKMON_DIRS = &quot;\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    STOPTASKS,${TMPDIR},1G,100K \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    STOPTASKS,${DL_DIR},1G,100K \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    STOPTASKS,${SSTATE_DIR},1G,100K \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    STOPTASKS,/tmp,100M,100K \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HALT,${TMPDIR},100M,1K \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HALT,${DL_DIR},100M,1K \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HALT,${SSTATE_DIR},100M,1K \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HALT,/tmp,10M,1K&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># general config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SDKMACHINE = &quot;x86_64&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONNECTIVITY_CHECK_URIS = &quot;https://www.google.com/&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># qemu configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PACKAGECONFIG:append:pn-qemu-system-native = &quot; sdl&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PACKAGECONFIG:append:pn-qemu-system-native = &quot; gtk+&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># systemd only</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INIT_MANAGER = &quot;systemd&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MACHINE ??= &quot;qemuarm&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DISTRO ??= &quot;poky&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BBMULTICONFIG ?= &quot;qemux86-64-erlang-elixir qemuarm64-erlang-elixir qemuarm-erlang-elixir qemux86-erlang-elixir qemux86-64-x32-erlang-elixir&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># To disable QA checks for https://github.com/meta-erlang/meta-erlang/issues/328</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ERROR_QA:remove = &quot;buildpaths&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="multiconfig-build">multiconfig build<a href="#multiconfig-build" class="hash-link" aria-label="Direct link to multiconfig build" title="Direct link to multiconfig build">​</a></h2>
<p>YP/OE provides a smart way to build the same image (or different images) for
multiple targets. It is called multiconfig build and it is fully described at
<a href="https://docs.yoctoproject.org/dev-manual/building.html?highlight=multiconfig#building-images-for-multiple-targets-using-multiple-configurations" target="_blank" rel="noopener noreferrer">Building Images for Multiple Targets Using Multiple Configurations</a>.</p>
<p>Four our context, don&#x27;t forget to checkout the section
<a href="#environment-setup">Environment setup</a>, we need to compare the erlang and
elixir packages using different processor architectures (<em>MACHINES</em> in YP/OE
language).</p>
<p>We can build five targets using the command below:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bitbake -c build \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    multiconfig:qemux86-64-erlang-elixir:core-image-minimal \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    multiconfig:qemux86-erlang-elixir:core-image-minimal \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    multiconfig:qemuarm-erlang-elixir:core-image-minimal \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    multiconfig:qemuarm64-erlang-elixir:core-image-minimal \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    multiconfig:qemux86-64-x32-erlang-elixir:core-image-minimal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The multiconfig build was configured to create a specific TMPDIR for each
processor architecture. Then, the final results at build folder will be one
folder for each architecture:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tmp-qemuarm64-glibc-erlang-elixir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tmp-qemuarm-glibc-erlang-elixir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tmp-qemux86-64-glibc-erlang-elixir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tmp-qemux86-64-glibc-x32-erlang-elixir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tmp-qemux86-glibc-erlang-elixir</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>That way, it&#x27;s easy to navigate into the final output files.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introspection-with-buildhistory">Introspection with buildhistory<a href="#introspection-with-buildhistory" class="hash-link" aria-label="Direct link to Introspection with buildhistory" title="Direct link to Introspection with buildhistory">​</a></h2>
<p>The buildhistory is a YP/OE feature that writes some meta data into a git
repository for further inspection. Then, it&#x27;s possible check and interact with
files using standard linux tools like find and grep to collect insights. Using
buildhistory is a shortcut because we can inspect how files would be installed
into the final image, without having to burn the image and boot it on a real (or
virtual) target.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Check out the
<a href="https://docs.yoctoproject.org/5.0.3/dev-manual/build-quality.html?highlight=buildhistory#enabling-and-disabling-build-history" target="_blank" rel="noopener noreferrer">Enabling and Disabling Build History</a>
instructions for how to enable buildhistory.</p></div></div>
<p>In this post we are interested in check the size of erlang and elixir packages.</p>
<p>After a success build and from the YP/OE build folder, it&#x27;s possible to explore
the buildhistory git repository:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd buildhistory/packages/cortexa57-poky-linux/erlang</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">find -name latest -print0 | xargs -0 grep PKGSIZE | sort</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd buildhistory/packages/cortexa57-poky-linux/elixir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">find -name latest -print0 | xargs -0 grep PKGSIZE | sort</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>PKGSIZE</code> gives to us the size in bytes of the final packages generated by
erlang and elixir recipes.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ypoe-packaging-for-erlang-and-elixir-recipes">YP/OE packaging for erlang and elixir recipes<a href="#ypoe-packaging-for-erlang-and-elixir-recipes" class="hash-link" aria-label="Direct link to YP/OE packaging for erlang and elixir recipes" title="Direct link to YP/OE packaging for erlang and elixir recipes">​</a></h2>
<p>The nature of Erlang/OTP is to isolate erlang modules into applications. The
Erlang/OTP source code embraces this philosophy and it is natural to transform
each application into an installed package (IPK, DEB, RPM). For that,
meta-erlang uses a simple script that creates a recipe manifest (see
<a href="https://github.com/meta-erlang/meta-erlang/blob/cb94887c108b63c6cba290cb019468f246df5ea4/scripts/contrib/erlang/generate-manifest#L76" target="_blank" rel="noopener noreferrer">erlang recipe manifest</a>
for details).</p>
<p>An erlang recipe manifest, for example
<a href="https://github.com/meta-erlang/meta-erlang/blob/cb94887c108b63c6cba290cb019468f246df5ea4/recipes-devtools/erlang/erlang-27.1-manifest.inc" target="_blank" rel="noopener noreferrer">erlang-27.1-manifest.inc</a>,
declares each Erlang/OTP application. For each application there are five
packages:</p>
<ul>
<li><code>application_name-doc</code>: documentation, man pages and examples</li>
<li><code>application_name-dbg</code>: debug symbols, if any</li>
<li><code>application_name-dev</code>: development C headers, shared libraries (*.so)</li>
<li><code>application_name-staticdev</code>: static libraries (*.a)</li>
<li><code>application_name</code>: BEAM modules and files from <code>priv</code> folder</li>
</ul>
<p>Where <code>application_name</code> is the name of the application like: kernel, stdlib,
sasl, ...</p>
<p>This separation is necessary because YP/OE splits the package of any recipe into
doc, dbg, dev and staticdev. Then, the user have more control about what will be
installed into the final image.</p>
<p>The elixir recipe follows the same way, but simpler (check out the
<a href="https://github.com/meta-erlang/meta-erlang/blob/cb94887c108b63c6cba290cb019468f246df5ea4/recipes-devtools/elixir/elixir.inc" target="_blank" rel="noopener noreferrer">elixir.inc</a>
include file).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="special-metapackages">Special metapackages<a href="#special-metapackages" class="hash-link" aria-label="Direct link to Special metapackages" title="Direct link to Special metapackages">​</a></h3>
<p>As there are many packages for erlang and elixir, sometimes we need to setup a
development environment will all erlang and elixir packages installed. Or a
minimum set of packages. There are a couple of metapackages created for that
purpose:</p>
<ul>
<li>erlang-modules: install <em>all</em> Erlang/OTP applications</li>
<li>erlang-modules-dev: install <em>all</em> Erlang/OTP applications development packages</li>
<li>elixir-modules: install <em>all</em> elixir applications</li>
<li>elixir-modules-dev: install <em>all</em> elixir applications development packages</li>
<li>erlang: install the minimal Erlang/OTP applications</li>
<li>elixir: install the minimal elixir applications</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="where-the-files-get-installed-">Where the files get installed ?<a href="#where-the-files-get-installed-" class="hash-link" aria-label="Direct link to Where the files get installed ?" title="Direct link to Where the files get installed ?">​</a></h3>
<p>The best way to awnser this is to take a look into buildhistory data.</p>
<p>At the build folder there is a folder called buildhistory. That folder is split
by images and packages. And for each architecture, there is a specific folder.
So, let&#x27;s check the first 20 lines from file: files-in-packages.txt for
erlang-erts package:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">head -n 20 buildhistory/packages/core2-32-poky-linux/erlang/erlang-erts/files-in-package.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x root       root             4096 ./usr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x root       root             4096 ./usr/bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx root       root               22 ./usr/bin/epmd -&gt; ../lib/erlang/bin/epmd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx root       root               21 ./usr/bin/erl -&gt; ../lib/erlang/bin/erl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx root       root               25 ./usr/bin/escript -&gt; ../lib/erlang/bin/escript</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx root       root               25 ./usr/bin/run_erl -&gt; ../lib/erlang/bin/run_erl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx root       root               24 ./usr/bin/to_erl -&gt; ../lib/erlang/bin/to_erl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x root       root             4096 ./usr/lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x root       root             4096 ./usr/lib/erlang</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x root       root             4096 ./usr/lib/erlang/bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx root       root               21 ./usr/lib/erlang/bin/epmd -&gt; ../erts-15.1/bin/epmd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwxr-xr-x root       root             1474 ./usr/lib/erlang/bin/erl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwxr-xr-x root       root           140752 ./usr/lib/erlang/bin/erl_call</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwxr-xr-x root       root            38456 ./usr/lib/erlang/bin/escript</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- root       root             6860 ./usr/lib/erlang/bin/no_dot_erlang.boot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwxr-xr-x root       root            25996 ./usr/lib/erlang/bin/run_erl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwxr-xr-x root       root             1745 ./usr/lib/erlang/bin/start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- root       root             6885 ./usr/lib/erlang/bin/start.boot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- root       root             6885 ./usr/lib/erlang/bin/start_clean.boot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwxr-xr-x root       root             1244 ./usr/lib/erlang/bin/start_erl</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="erlang-package-sizes">erlang package sizes<a href="#erlang-package-sizes" class="hash-link" aria-label="Direct link to erlang package sizes" title="Direct link to erlang package sizes">​</a></h2>
<p>When installing the metapackage called <code>erlang</code> the following packages will be
automatically installed:</p>
<ul>
<li>erlang-erts</li>
<li>erlang-kernel</li>
<li>erlang-stdlib</li>
<li>erlang-sasl</li>
</ul>
<p>These packages are the basic ones needed in order to run Erlang programs.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Actually, your application is in charge of making a proper Erlang/OTP
release. Installing the package <code>erlang</code> is an option if you need it installed
into standard locations. Otherwise, your application should produce a valide
release with a builtin ERTS inside.</p></div></div>
<p>The following charts are listed below to get a view about the size of those
basic erlang packages.</p>
<p>The difference between each build, besides the processor architecture, is the
size in bytes of the package erlang-erts. That makes sense because that package
is the ERTS (which is architecture dependent, like word size). On other hand,
the packages kernel, stdlib, sasl have the same size across all builds.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="qemux86">qemux86<a href="#qemux86" class="hash-link" aria-label="Direct link to qemux86" title="Direct link to qemux86">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bitbake -c build multiconfig:qemux86-erlang-elixir:core-image-minimal</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="qemux86-64">qemux86-64<a href="#qemux86-64" class="hash-link" aria-label="Direct link to qemux86-64" title="Direct link to qemux86-64">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bitbake -c build multiconfig:qemux86-64-erlang-elixir:core-image-minimal</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="qemux86-64-with-x32-psabi">qemux86-64 with x32 psABI<a href="#qemux86-64-with-x32-psabi" class="hash-link" aria-label="Direct link to qemux86-64 with x32 psABI" title="Direct link to qemux86-64 with x32 psABI">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bitbake -c build multiconfig:x86_64_x32-poky-linux-gnux32:core-image-minimal</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Enabling x32 psABI should be considered if your application needs to
handle 64-bit features, but you can&#x27;t afford wasting space with addressing. See
the blog post <a href="/blog/2023/09/02/index/">Exploring x32 psABI for Erlang/OTP</a>.</p><p>The package size difference in bytes between x32 build and a normal x86-64
is 4615556.</p></div></div>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="qemuarm64">qemuarm64<a href="#qemuarm64" class="hash-link" aria-label="Direct link to qemuarm64" title="Direct link to qemuarm64">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bitbake -c build multiconfig:qemuarm64-erlang-elixir:core-image-minimal</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="qemuarm">qemuarm<a href="#qemuarm" class="hash-link" aria-label="Direct link to qemuarm" title="Direct link to qemuarm">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bitbake -c build multiconfig:qemuarm-erlang-elixir:core-image-minimal</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<!-- -->
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="elixir-package-sizes">elixir package sizes<a href="#elixir-package-sizes" class="hash-link" aria-label="Direct link to elixir package sizes" title="Direct link to elixir package sizes">​</a></h2>
<p>When installing the metapackage called <code>elixir</code> the following packages will be
automatically installed:</p>
<ul>
<li>erlang (see <a href="#erlang-package-sizes">erlang package size for details</a>)</li>
<li>erlang-compiler</li>
</ul>
<p>That is because elixir package needs erlang (erts, kernel, stdlib and sasl)
installed. And, the erlang compiler is also a requirement.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Again, your application should manage a release for best results.
Installing the package <code>elixir</code> only makes sense for testing purposes.</p></div></div>
<p>The following table summarizes the packages sizes per processor architecture.</p>
<table><thead><tr><th>Processor architecture</th><th>Package size in bytes</th></tr></thead><tbody><tr><td>core2-32-poky-linux (qemux86)</td><td>5760108</td></tr><tr><td>core2-64-poky-linux (qemux86-64)</td><td>5760368</td></tr><tr><td>qemux86-64-x32-erlang-elixir</td><td>5763392</td></tr><tr><td>cortexa57-poky-linux (qemuarm64)</td><td>5760476</td></tr><tr><td>cortexa15t2hf-neon-poky-linux-gnueabi</td><td>5764076</td></tr></tbody></table>
<p>There are slight size differences. It should not as there is no architecture
dependency on elixir beam files.</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/meta-erlang/">meta-erlang</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/x-32/">x32</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/meta-erlang/meta-erlang.github.io/tree/master/blog/2024-10-06/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2024/10/12/index/"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Running Erlang/OTP test suite on target with ptest</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2024/09/24/index/"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">fwup for A/B image upgrades, part I</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#environment-setup" class="table-of-contents__link toc-highlight">Environment setup</a></li><li><a href="#multiconfig-build" class="table-of-contents__link toc-highlight">multiconfig build</a></li><li><a href="#introspection-with-buildhistory" class="table-of-contents__link toc-highlight">Introspection with buildhistory</a></li><li><a href="#ypoe-packaging-for-erlang-and-elixir-recipes" class="table-of-contents__link toc-highlight">YP/OE packaging for erlang and elixir recipes</a><ul><li><a href="#special-metapackages" class="table-of-contents__link toc-highlight">Special metapackages</a></li><li><a href="#where-the-files-get-installed-" class="table-of-contents__link toc-highlight">Where the files get installed ?</a></li></ul></li><li><a href="#erlang-package-sizes" class="table-of-contents__link toc-highlight">erlang package sizes</a><ul><li><a href="#qemux86" class="table-of-contents__link toc-highlight">qemux86</a></li><li><a href="#qemux86-64" class="table-of-contents__link toc-highlight">qemux86-64</a></li><li><a href="#qemux86-64-with-x32-psabi" class="table-of-contents__link toc-highlight">qemux86-64 with x32 psABI</a></li><li><a href="#qemuarm64" class="table-of-contents__link toc-highlight">qemuarm64</a></li><li><a href="#qemuarm" class="table-of-contents__link toc-highlight">qemuarm</a></li></ul></li><li><a href="#elixir-package-sizes" class="table-of-contents__link toc-highlight">elixir package sizes</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://erlangforums.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Erlang Forums<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://elixirforum.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Elixir Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://erlef.org/wg/embedded" target="_blank" rel="noopener noreferrer" class="footer__link-item">EEF Embedded Working Group<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/community/support/">Help</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog/">Blog</a></li><li class="footer__item"><a href="https://github.com/meta-erlang/meta-erlang" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024-2025 meta-erlang</div></div></div></footer></div>
</body>
</html>