"use strict";(self.webpackChunkmeta_erlang_github_io=self.webpackChunkmeta_erlang_github_io||[]).push([[5798],{5581:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>r,contentTitle:()=>d,default:()=>l,frontMatter:()=>t,metadata:()=>a,toc:()=>o});var c=s(4848),i=s(8453);const t={sidebar_position:4.1,sidebar_label:"couchdb",sidebar_class_name:"green",description:"Shows how to set up and install couchdb."},d="couchdb",a={id:"applications/guides-couchdb",title:"couchdb",description:"Shows how to set up and install couchdb.",source:"@site/docs/applications/guides-couchdb.md",sourceDirName:"applications",slug:"/applications/guides-couchdb",permalink:"/docs/master/applications/guides-couchdb",draft:!1,unlisted:!1,editUrl:"https://github.com/meta-erlang/meta-erlang.github.io/tree/master/docs/applications/guides-couchdb.md",tags:[],version:"current",sidebarPosition:4.1,frontMatter:{sidebar_position:4.1,sidebar_label:"couchdb",sidebar_class_name:"green",description:"Shows how to set up and install couchdb."},sidebar:"tutorialSidebar",previous:{title:"Applications",permalink:"/docs/master/category/applications"},next:{title:"livebook",permalink:"/docs/master/applications/guides-livebook"}},r={},o=[];function h(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",header:"header",img:"img",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"couchdb",children:"couchdb"})}),"\n",(0,c.jsx)(n.admonition,{type:"warning",children:(0,c.jsxs)(n.p,{children:["The couchdb recipe has been temporary removed from meta-erlang master branch.\nPlease, see\n",(0,c.jsx)(n.a,{href:"https://github.com/meta-erlang/meta-erlang/pull/293",children:"PR couchdb: move to main branch and remove mozjs"}),"\nfor more details."]})}),"\n",(0,c.jsxs)(n.admonition,{type:"info",children:[(0,c.jsx)(n.p,{children:"Recommended PREFERRED_VERSION for couchdb:"}),(0,c.jsxs)(n.table,{children:[(0,c.jsx)(n.thead,{children:(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.th,{children:"couchdb"}),(0,c.jsx)(n.th,{children:"Erlang/OTP"}),(0,c.jsx)(n.th,{children:"Elixir"})]})}),(0,c.jsx)(n.tbody,{children:(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"3.3.3"}),(0,c.jsx)(n.td,{children:"25.3%"}),(0,c.jsx)(n.td,{children:"1.14%"})]})})]})]}),"\n",(0,c.jsxs)(n.p,{children:["In this guide we are using the plain meta-erlang layer to build the\n",(0,c.jsx)(n.a,{href:"https://couchdb.apache.org/",children:"couchdb"}),"."]}),"\n",(0,c.jsxs)(n.p,{children:["The recipe\n",(0,c.jsx)(n.a,{href:"https://github.com/meta-erlang/meta-erlang/blob/master/recipes-database/couchdb/couchdb.inc",children:"couchdb.inc"}),"\nbuilds the couchdb using a crosscompile approach. couchdb prefers to work with a\nfull erlang release instead of use the Erlang packages installed on the final\nimage."]}),"\n",(0,c.jsx)(n.p,{children:"As a final result, we are able to run an embedded couchdb using qemu."}),"\n",(0,c.jsx)(n.p,{children:"Follow the quickstart guide to get a basic working environment and then:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["Add erlang preferred version 22.x in ",(0,c.jsx)(n.em,{children:"conf/local.conf"})," (check the full list of\nErlang supported versions here\n",(0,c.jsx)(n.a,{href:"https://docs.couchdb.org/en/stable/install/unix.html#dependencies",children:"Dependencies"}),")"]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:'echo \'PREFERRED_VERSION_erlang = "22%"\n'})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["Add ",(0,c.jsx)(n.code,{children:"couchdb"})," package to ",(0,c.jsx)(n.code,{children:"IMAGE_INSTAL"})," in ",(0,c.jsx)(n.em,{children:"conf/local.conf"})]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"echo 'IMAGE_INSTALL:append = \" couchdb\"' >> conf/local.conf\n"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Now its time to build the image:"}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"bitbake core-image-minimal\n"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"And check the results with qemu:"}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"runqemu core-image-minimal\n"})}),"\n",(0,c.jsxs)(n.p,{children:["couchdb needs two additional manual configurations in the config file\n(",(0,c.jsx)(n.em,{children:"/opt/couchdb/etc/local.ini"}),")."]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["The first one is to enable the dashboard remote access. Find the session\n",(0,c.jsx)(n.code,{children:"chttpd"})," and change the bind_address. Like this:"]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"[chttpd]\nport = 5984\nbind_address = 0.0.0.0\n"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"The second one is necessary to add a administrator user to the couchdb\ninstance. Like this:"}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"[admins]\nadmin = mysecretpassword\n"})}),"\n",(0,c.jsxs)(n.p,{children:["Restart or start the couchdb service using the init scripts\n(",(0,c.jsx)(n.code,{children:"/etc/init.d/couchdb restart"})," or ",(0,c.jsx)(n.code,{children:"systemctl restart couchdb"}),")."]}),"\n",(0,c.jsxs)(n.p,{children:["couchdb has a nice dashboard where we can check the database and do all the\nmaintenance as well creating documents. Access the address\n",(0,c.jsx)(n.a,{href:"http://192.168.7.2:5984/_utils/index.html",children:"http://192.168.7.2:5984/_utils/index.html"})," to get into the dashboard:"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{alt:"couchdb dashboard",src:s(6680).A+"",width:"1363",height:"687"})})]})}function l(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(h,{...e})}):h(e)}},6680:(e,n,s)=>{s.d(n,{A:()=>c});const c=s.p+"assets/images/couchdb_dashboard-62c18ba4e3821deeceb951e315d1359f.png"},8453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>a});var c=s(6540);const i={},t=c.createContext(i);function d(e){const n=c.useContext(t);return c.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),c.createElement(t.Provider,{value:n},e.children)}}}]);